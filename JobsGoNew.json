{
  "name": "JobsGo",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -896,
        160
      ],
      "id": "fe777ca4-01c2-45bf-97bb-4ad97e038841",
      "name": "When clicking ‚ÄòExecute workflow‚Äô"
    },
    {
      "parameters": {
        "operation": "clear",
        "documentId": {
          "__rl": true,
          "value": "1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc",
          "mode": "list",
          "cachedResultName": "JobsGo",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1293046103,
          "mode": "list",
          "cachedResultName": "danh s√°ch c√¥ng vi·ªác ƒë√£ crawl",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc/edit#gid=1293046103"
        },
        "keepFirstRow": true
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -640,
        -208
      ],
      "id": "7b666c77-c6f3-447a-966e-425701f75bdc",
      "name": "X√≥a danh s√°ch c√¥ng vi·ªác ƒë√£ crawl",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KWvXTlQdV9eqObfN",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc",
          "mode": "list",
          "cachedResultName": "JobsGo",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "list url c·∫ßn crawl",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -640,
        160
      ],
      "id": "01a64915-cead-453a-8d1c-6a3093ca4db0",
      "name": "L·∫•y ƒë·ªØ li·ªáu sheet list url c·∫ßn crawl",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KWvXTlQdV9eqObfN",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "runCustomScript",
        "scriptCode": "// üü© Script Puppeteer t·ªïng h·ª£p - 1 browser cho t·∫•t c·∫£\n// Input: Array of search URLs v·ªõi Major t·ª´ sheet\n\nconst sleep = (ms) => new Promise((res) => setTimeout(res, ms));\n\n// üü© L·∫•y t·∫•t c·∫£ search URLs t·ª´ input\nconst searchUrls = $input.all();\n\nif (!searchUrls || searchUrls.length === 0) {\n  throw new Error(\"‚ùå Kh√¥ng c√≥ search URLs!\");\n}\n\n// üü© Setup browser m·ªôt l·∫ßn\nlet allJobLinks = []; // M·∫£ng ch·ª©a job links (raw data)\nlet allJobDetails = []; // M·∫£ng ch·ª©a job details (raw data)\n\n// üü© Setup request interception (m·ªôt l·∫ßn)\nawait $page.setRequestInterception(true);\n$page.on(\"request\", (req) => {\n  const t = req.resourceType();\n  const u = req.url();\n  if ([\"image\", \"font\", \"media\"].includes(t) || /doubleclick|googletagmanager|analytics|facebook|adsystem|adservice|hotjar|mixpanel/i.test(u)) {\n    return req.abort();\n  }\n  req.continue();\n});\n\n// üü© Setup User-Agent v√† headers (m·ªôt l·∫ßn)\nawait $page.setUserAgent('Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36');\nawait $page.setExtraHTTPHeaders({\n  'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',\n  'Accept-Language': 'vi-VN,vi;q=0.9,en-US;q=0.8,en;q=0.7',\n  'Accept-Encoding': 'gzip, deflate, br',\n  'Connection': 'keep-alive',\n  'Upgrade-Insecure-Requests': '1'\n});\n\ntry {\n  // üü© LOOP 1: Qua t·ª´ng search URL\n  for (let searchIdx = 0; searchIdx < searchUrls.length; searchIdx++) {\n    const searchData = searchUrls[searchIdx].json;\n    const searchUrl = searchData.Url || searchData.url || searchData.link;\n    const major = searchData.Major || searchData.major || \"\";\n    \n    if (!searchUrl) {\n      console.log(`‚ö†Ô∏è B·ªè qua search URL ${searchIdx + 1}: Kh√¥ng c√≥ URL`);\n      continue;\n    }\n    \n    console.log(`\\nüü¶ [${searchIdx + 1}/${searchUrls.length}] ƒêang x·ª≠ l√Ω search URL: ${searchUrl}`);\n    \n    // üü© B∆Ø·ªöC 1: L·∫•y danh s√°ch job links t·ª´ search URL\n    let jobLinks = [];\n    \n    try {\n      // ƒêi ƒë·∫øn search URL\n      await $page.goto(searchUrl, {\n        waitUntil: \"domcontentloaded\",\n        timeout: 30000\n      });\n      \n      // ƒê·ª£i job cards xu·∫•t hi·ªán\n      try {\n        await $page.waitForSelector(\".col-grid .card.job-card, .card.job-card\", {\n          timeout: 15000\n        });\n      } catch (e) {\n        console.log(`‚ö†Ô∏è Kh√¥ng th·∫•y job items ·ªü ${searchUrl}`);\n        continue;\n      }\n      \n      // Cu·ªôn ƒë·ªÉ load h·∫øt job\n      let lastCount = 0;\n      let noChangeCount = 0;\n      for (let i = 0; i < 10; i++) {\n        await $page.evaluate(() => window.scrollBy(0, document.body.scrollHeight));\n        await sleep(500);\n        \n        const currentCount = await $page.$$eval(\n          \".col-grid .card.job-card, .card.job-card\",\n          (els) => els.length\n        );\n        \n        if (currentCount === lastCount) {\n          noChangeCount++;\n          if (noChangeCount >= 2) break;\n        } else {\n          noChangeCount = 0;\n        }\n        lastCount = currentCount;\n      }\n      \n      // L·∫•y danh s√°ch job links (raw data - kh√¥ng format)\n      jobLinks = await $page.evaluate(() => {\n        const links = [];\n        const jobCards = document.querySelectorAll(\".col-grid .card.job-card, .card.job-card\");\n        \n        jobCards.forEach((card) => {\n          const linkEl = card.querySelector(\"a[href*='/viec-lam/']\");\n          if (!linkEl) return;\n          \n          const href = linkEl.getAttribute(\"href\") || linkEl.href || \"\";\n          if (!href || href.includes(\"#\")) return;\n          \n          let fullUrl = href;\n          if (href.startsWith(\"/\")) {\n            fullUrl = \"https://jobsgo.vn\" + href;\n          }\n          \n          if (fullUrl && !links.includes(fullUrl)) {\n            links.push(fullUrl);\n          }\n        });\n        \n        return links;\n      });\n      \n      console.log(`‚úÖ T√¨m th·∫•y ${jobLinks.length} job links t·ª´ ${searchUrl}`);\n      \n      // Th√™m v√†o allJobLinks v·ªõi raw data\n      jobLinks.forEach(link => {\n        allJobLinks.push({\n          type: \"jobLink\",\n          Url: link,\n          Source: searchUrl,\n          Major: major\n        });\n      });\n      \n    } catch (error) {\n      console.log(`‚ùå L·ªói khi l·∫•y job links t·ª´ ${searchUrl}: ${error.message}`);\n      continue;\n    }\n    \n    // üü© LOOP 2: Qua t·ª´ng job link ƒë·ªÉ l·∫•y chi ti·∫øt (raw data)\n    for (let jobIdx = 0; jobIdx < jobLinks.length; jobIdx++) {\n      const jobLink = jobLinks[jobIdx];\n      \n      console.log(`  üîπ [${jobIdx + 1}/${jobLinks.length}] ƒêang crawl: ${jobLink}`);\n      \n      try {\n        // Delay ƒë·ªÉ tr√°nh b·ªã ch·∫∑n\n        await sleep(1000 + Math.random() * 2000);\n        \n        // ƒêi ƒë·∫øn job detail page\n        await $page.goto(jobLink, {\n          waitUntil: \"domcontentloaded\",\n          timeout: 30000\n        });\n        \n        // ƒê·ª£i n·ªôi dung load\n        await sleep(2000);\n        \n        // Ch·ªù ti√™u ƒë·ªÅ xu·∫•t hi·ªán\n        try {\n          await $page.waitForSelector(\"h1.job-title, body\", { timeout: 30000 });\n        } catch (e) {\n          console.log(`    ‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y ti√™u ƒë·ªÅ, ti·∫øp t·ª•c...`);\n        }\n        \n        // Cu·ªôn ƒë·ªÉ t·∫£i h·∫øt n·ªôi dung\n        await $page.evaluate(async () => {\n          await new Promise(res => {\n            let y = 0;\n            const step = 1000;\n            const t = setInterval(() => {\n              window.scrollBy(0, step);\n              y += step;\n              if (y > document.body.scrollHeight + 1200) {\n                clearInterval(t);\n                res();\n              }\n            }, 80);\n          });\n        });\n        await sleep(300);\n        \n        // L·∫•y raw data t·ª´ job detail page (kh√¥ng format)\n        const rawJobData = await $page.evaluate(() => {\n          const get = (sel) => {\n            try {\n              const el = document.querySelector(sel);\n              return el?.textContent?.trim() || null;\n            } catch { return null; }\n          };\n          \n          const findByLabel = (labels) => {\n            const cols = document.querySelectorAll(\".card-body .col-6, .card-body .col-md-4\");\n            for (const col of cols) {\n              const labelEl = col.querySelector(\".text-muted\");\n              if (!labelEl) continue;\n              const labelText = labelEl.textContent?.trim() || \"\";\n              for (const label of labels) {\n                if (labelText.toLowerCase().includes(label.toLowerCase())) {\n                  const strongEl = col.querySelector(\"strong\");\n                  if (strongEl) {\n                    return strongEl.textContent?.trim() || null;\n                  }\n                }\n              }\n            }\n            return null;\n          };\n          \n          const title = get(\"h1.job-title\") || null;\n          const company = get(\".card-company h6.fw-semibold\") || get(\".company-logo + .flex-grow-1 h6\") || null;\n          \n          let salary = null;\n          const jobInfoList = document.querySelector(\".job-info-list\");\n          if (jobInfoList) {\n            const salaryLi = Array.from(jobInfoList.querySelectorAll(\"li\")).find(li => {\n              return li.textContent?.includes(\"M·ª©c l∆∞∆°ng\") || li.textContent?.includes(\"l∆∞∆°ng\");\n            });\n            if (salaryLi) {\n              const strongEl = salaryLi.querySelector(\"strong\");\n              if (strongEl) {\n                salary = strongEl.textContent?.trim() || null;\n              }\n            }\n          }\n          \n          const education = findByLabel([\"Y√™u c·∫ßu b·∫±ng c·∫•p\", \"b·∫±ng c·∫•p\", \"Tr√¨nh ƒë·ªô\"]) || null;\n          const position = findByLabel([\"V·ªã tr√≠/ch·ª©c v·ª•\", \"V·ªã tr√≠\", \"Ch·ª©c v·ª•\"]) || null;\n          const experience = findByLabel([\"Y√™u c·∫ßu kinh nghi·ªám\", \"Kinh nghi·ªám\"]) || null;\n          const postedDate = findByLabel([\"Ng√†y ƒëƒÉng tuy·ªÉn\", \"Ng√†y ƒëƒÉng\"]) || null;\n          \n          let deadline = null;\n          if (jobInfoList) {\n            const deadlineLi = Array.from(jobInfoList.querySelectorAll(\"li\")).find(li => {\n              return li.textContent?.includes(\"H·∫°n n·ªôp\") || li.textContent?.includes(\"H·∫øt h·∫°n\");\n            });\n            if (deadlineLi) {\n              const strongEl = deadlineLi.querySelector(\"strong\");\n              if (strongEl) {\n                deadline = strongEl.textContent?.trim() || null;\n              }\n            }\n          }\n          \n          return {\n            title: title,\n            company: company,\n            salary: salary,\n            education: education,\n            position: position,\n            experience: experience,\n            quantity: null,\n            postedDate: postedDate,\n            deadline: deadline,\n            link: window.location.href\n          };\n        });\n        \n        // Th√™m Major v√†o raw data\n        rawJobData.major = major;\n        rawJobData.type = \"jobDetail\";\n        \n        allJobDetails.push(rawJobData);\n        console.log(`    ‚úÖ ƒê√£ crawl: ${rawJobData.title || 'N/A'}`);\n        \n      } catch (error) {\n        console.log(`    ‚ùå L·ªói khi crawl ${jobLink}: ${error.message}`);\n        continue;\n      }\n    }\n    \n    // Delay gi·ªØa c√°c search URL\n    await sleep(2000);\n  }\n  \n  console.log(`\\nüéØ Ho√†n th√†nh! T·ªïng c·ªông:`);\n  console.log(`   - ${allJobLinks.length} job links`);\n  console.log(`   - ${allJobDetails.length} job details`);\n  \n  // üü© Return raw data (s·∫Ω ƒë∆∞·ª£c format ·ªü Function node)\n  const allData = [...allJobLinks, ...allJobDetails];\n  return allData.map(item => ({ json: item }));\n  \n} catch (error) {\n  console.log(`‚ùå L·ªói nghi√™m tr·ªçng: ${error.message}`);\n  throw error;\n} finally {\n  // üü© CLEANUP: ƒê·∫£m b·∫£o browser ƒë∆∞·ª£c ƒë√≥ng\n  try {\n    if (!$page.isClosed()) {\n      await $page.setRequestInterception(false);\n    }\n    $page.removeAllListeners('request');\n  } catch (e) {\n    // Ignore cleanup errors\n  }\n}",
        "options": {
          "args": [
            "--no-sandbox",
            "--disable-setuid-sandbox",
            "--disable-dev-shm-usage",
            "--disable-accelerated-2d-canvas",
            "--no-first-run",
            "--disable-gpu",
            "--disable-background-timer-throttling",
            "--disable-backgrounding-occluded-windows",
            "--disable-renderer-backgrounding"
          ]
        }
      },
      "type": "n8n-nodes-puppeteer.puppeteer",
      "typeVersion": 1,
      "position": [
        -112,
        256
      ],
      "id": "087f1f3d-e64b-49a3-b778-28a211b1e54a",
      "name": "Truy c·∫≠p v√†o link l·∫•y ra c√¥ng vi·ªác",
      "alwaysOutputData": true,
      "executeOnce": false,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc",
          "mode": "list",
          "cachedResultName": "JobsGo",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1293046103,
          "mode": "list",
          "cachedResultName": "danh s√°ch c√¥ng vi·ªác ƒë√£ crawl",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1i077qGPoAgK1XLcbCLziqppsyFjwllMOpevn06Y1tXM/edit#gid=1293046103"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "L∆∞∆°ng": "={{ $json[\"L∆∞∆°ng\"] }}",
            "Tr√¨nh ƒë·ªô": "={{ $json[\"Tr√¨nh ƒë·ªô\"] }}",
            "S·ªë l∆∞·ª£ng": "={{ $json[\"S·ªë l∆∞·ª£ng\"] }}",
            "Kinh nghi·ªám": "={{ $json[\"Kinh nghi·ªám\"] }}",
            "Ng√†y ƒëƒÉng": "={{ $json[\"Ng√†y ƒëƒÉng\"] }}",
            "V·ªã tr√≠": "={{ $json[\"V·ªã tr√≠\"] }}",
            "H·∫°n tuy·ªÉn d·ª•ng": "={{ $json[\"H·∫°n tuy·ªÉn d·ª•ng\"] }}",
            "Chuy√™n ng√†nh": "={{ $json[\"Chuy√™n ng√†nh\"] }}",
            "Ti√™u ƒë·ªÅ c√¥ng vi·ªác": "={{ $json[\"Ti√™u ƒë·ªÅ c√¥ng vi·ªác\"] }}",
            "T√™n c√¥ng ty": "={{ $json[\"T√™n c√¥ng ty\"] }}",
            "Link": "={{ $json.Link }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Ti√™u ƒë·ªÅ c√¥ng vi·ªác",
              "displayName": "Ti√™u ƒë·ªÅ c√¥ng vi·ªác",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "T√™n c√¥ng ty",
              "displayName": "T√™n c√¥ng ty",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Link",
              "displayName": "Link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "L∆∞∆°ng",
              "displayName": "L∆∞∆°ng",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Tr√¨nh ƒë·ªô",
              "displayName": "Tr√¨nh ƒë·ªô",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "V·ªã tr√≠",
              "displayName": "V·ªã tr√≠",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Kinh nghi·ªám",
              "displayName": "Kinh nghi·ªám",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "S·ªë l∆∞·ª£ng",
              "displayName": "S·ªë l∆∞·ª£ng",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Ng√†y ƒëƒÉng",
              "displayName": "Ng√†y ƒëƒÉng",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "H·∫°n tuy·ªÉn d·ª•ng",
              "displayName": "H·∫°n tuy·ªÉn d·ª•ng",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Chuy√™n ng√†nh",
              "displayName": "Chuy√™n ng√†nh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        768,
        272
      ],
      "id": "1cdb4be9-79c3-4bdf-ae6d-e0dc04170bc5",
      "name": "Th√™m ƒë·ªØ li·ªáu v√†o sheet danh s√°ch c√¥ng vi·ªác ƒë√£ crawl",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KWvXTlQdV9eqObfN",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc",
          "mode": "list",
          "cachedResultName": "JobsGo",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2020572363,
          "mode": "list",
          "cachedResultName": "list link tuy·ªÉn d·ª•ng ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1i077qGPoAgK1XLcbCLziqppsyFjwllMOpevn06Y1tXM/edit#gid=2020572363"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Url": "={{$json.link }}",
            "Source": "={{ $json.Source }}",
            "Major": "={{ $json.Major }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Source",
              "displayName": "Source",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Url",
              "displayName": "Url",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Major",
              "displayName": "Major",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        768,
        16
      ],
      "id": "0ded2c08-716b-4f0e-85bc-e5bfe9d5eea5",
      "name": "Th√™m ƒë·ªØ li·ªáu v√†o sheet list link tuy·ªÉn d·ª•ng",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KWvXTlQdV9eqObfN",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -368,
        160
      ],
      "id": "1faa76c1-fd0d-4789-bdfa-35443d0b4e11",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "operation": "clear",
        "documentId": {
          "__rl": true,
          "value": "1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc",
          "mode": "list",
          "cachedResultName": "JobsGo",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2020572363,
          "mode": "list",
          "cachedResultName": "list link tuy·ªÉn d·ª•ng ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_Kp74rA_Ndx8-aEC7V5-mEzs2F61gRhjuy4wfa8cOnc/edit#gid=2020572363"
        },
        "keepFirstRow": true
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -640,
        -48
      ],
      "id": "556d75e8-9a56-464d-85b9-449fe9a4d74a",
      "name": "X√≥a ƒë·ªØ li·ªáu c·ªßa sheet list link tuy·ªÉn d·ª•ng",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KWvXTlQdV9eqObfN",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// üü© Format data t·ª´ raw data\nconst items = $input.all();\nconst formattedItems = [];\n\nfor (const item of items) {\n  const data = item.json;\n  \n  // Format job links\n  if (data.type === \"jobLink\") {\n    formattedItems.push({\n      json: {\n        Url: data.Url || \"\",\n        Source: data.Source || \"\",\n        Major: data.Major || \"\",\n        link: data.Url || \"\"\n      }\n    });\n  }\n  \n  // Format job details\n  if (data.type === \"jobDetail\") {\n    // H√†m l√†m s·∫°ch text\n    const cleanText = (text) => {\n      if (!text) return \"\";\n      return text.trim();\n    };\n    \n    // Format l∆∞∆°ng: \"th∆∞∆°ng l∆∞·ª£ng\" => ƒë·ªÉ tr·ªëng\n    let salary = cleanText(data.salary || \"\");\n    if (salary && salary.toLowerCase().includes(\"th∆∞∆°ng l∆∞·ª£ng\")) {\n      salary = \"\";\n    }\n    \n    // Format tr√¨nh ƒë·ªô: \"Kh√¥ng gi·ªõi h·∫°n\" => ƒë·ªÉ tr·ªëng\n    let education = cleanText(data.education || \"\");\n    if (education && education.toLowerCase().includes(\"kh√¥ng gi·ªõi h·∫°n\")) {\n      education = \"\";\n    }\n    \n    // Format s·ªë l∆∞·ª£ng: \"Kh√¥ng x√°c ƒë·ªãnh\", \"Kh√¥ng hi·ªÉn th·ªã\" => \"1\"\n    let quantity = cleanText(data.quantity || \"\");\n    if (quantity && (quantity.toLowerCase().includes(\"kh√¥ng x√°c ƒë·ªãnh\") || quantity.toLowerCase().includes(\"kh√¥ng hi·ªÉn th·ªã\"))) {\n      quantity = \"1\";\n    }\n    \n    formattedItems.push({\n      json: {\n        \"Ti√™u ƒë·ªÅ c√¥ng vi·ªác\": cleanText(data.title) || \"Kh√¥ng x√°c ƒë·ªãnh\",\n        \"T√™n c√¥ng ty\": cleanText(data.company) || \"Kh√¥ng x√°c ƒë·ªãnh\",\n        \"Link\": data.link || \"\",\n        \"L∆∞∆°ng\": salary,\n        \"Tr√¨nh ƒë·ªô\": education,\n        \"V·ªã tr√≠\": cleanText(data.position) || \"\",\n        \"Kinh nghi·ªám\": cleanText(data.experience) || \"\",\n        \"S·ªë l∆∞·ª£ng\": quantity,\n        \"Ng√†y ƒëƒÉng\": cleanText(data.postedDate) || \"\",\n        \"H·∫°n tuy·ªÉn d·ª•ng\": cleanText(data.deadline) || \"\",\n        \"Chuy√™n ng√†nh\": cleanText(data.major) || \"\"\n      }\n    });\n  }\n}\n\nreturn formattedItems;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        432,
        272
      ],
      "id": "e00fb02b-879e-49c2-a73e-692d84f227dc",
      "name": "format l·∫°i d·ªØ li·ªáu"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        128,
        256
      ],
      "id": "78baa19d-9335-4111-ba92-e4b3e5212794",
      "name": "L·∫∑p x·ª≠ l√Ω"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1184,
        256
      ],
      "id": "1a169225-6f62-447d-900b-31c26f3c0b52",
      "name": "Merge"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking ‚ÄòExecute workflow‚Äô": {
      "main": [
        [
          {
            "node": "L·∫•y ƒë·ªØ li·ªáu sheet list url c·∫ßn crawl",
            "type": "main",
            "index": 0
          },
          {
            "node": "X√≥a ƒë·ªØ li·ªáu c·ªßa sheet list link tuy·ªÉn d·ª•ng",
            "type": "main",
            "index": 0
          },
          {
            "node": "X√≥a danh s√°ch c√¥ng vi·ªác ƒë√£ crawl",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "L·∫•y ƒë·ªØ li·ªáu sheet list url c·∫ßn crawl": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Truy c·∫≠p v√†o link l·∫•y ra c√¥ng vi·ªác": {
      "main": [
        [
          {
            "node": "L·∫∑p x·ª≠ l√Ω",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Th√™m ƒë·ªØ li·ªáu v√†o sheet list link tuy·ªÉn d·ª•ng": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Th√™m ƒë·ªØ li·ªáu v√†o sheet danh s√°ch c√¥ng vi·ªác ƒë√£ crawl": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Truy c·∫≠p v√†o link l·∫•y ra c√¥ng vi·ªác",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "format l·∫°i d·ªØ li·ªáu": {
      "main": [
        [
          {
            "node": "Th√™m ƒë·ªØ li·ªáu v√†o sheet list link tuy·ªÉn d·ª•ng",
            "type": "main",
            "index": 0
          },
          {
            "node": "Th√™m ƒë·ªØ li·ªáu v√†o sheet danh s√°ch c√¥ng vi·ªác ƒë√£ crawl",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "L·∫∑p x·ª≠ l√Ω": {
      "main": [
        [],
        [
          {
            "node": "format l·∫°i d·ªØ li·ªáu",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "L·∫∑p x·ª≠ l√Ω",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "44a0bada-74ce-4525-a650-1491bf6c0b36",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "be4bd479f567f96620153db3fcd673abbd059c76f34103f7251e61fb5e9ec621"
  },
  "id": "YXE0QQUhm8K4SQdx",
  "tags": []
}